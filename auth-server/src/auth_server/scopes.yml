# Pure new RBAC scopes for registry server/agent APIs.
# Scopes configuration for role-based permissions focused on server/agent APIs.
#
# Roles:
# - registry-admin: full access
# - registry-power-user: create/delete/share servers, read agents
# - registry-user: create servers and agents, cannot share
# - registry-read-only: read-only access to servers and agents

UI-Scopes:
  registry-admin:
    list_agents:
      - all
    get_agent:
      - all
    publish_agent:
      - all
    modify_agent:
      - all
    delete_agent:
      - all
    list_service:
      - all
    register_service:
      - all
    health_check_service:
      - all
    toggle_service:
      - all
    modify_service:
      - all
    delete_service:
      - all
    share_service:
      - all

  registry-power-user:
    list_agents:
      - all
    get_agent:
      - all
    list_service:
      - all
    register_service:
      - all
    delete_service:
      - all
    share_service:
      - all

  registry-user:
    list_agents:
      - all
    get_agent:
      - all
    publish_agent:
      - all
    list_service:
      - all
    register_service:
      - all

  registry-read-only:
    list_agents:
      - all
    get_agent:
      - all
    list_service:
      - all

group_mappings:
  jarvis-registry-admin:
    - registry-admin
  jarvis-registry-power-user:
    - registry-power-user
  jarvis-registry-user:
    - registry-user
  jarvis-registry-read-only:
    - registry-read-only
  registry-admin:
    - registry-admin
  registry-power-user:
    - registry-power-user
  registry-user:
    - registry-user
  registry-read-only:
    - registry-read-only

registry-admin:
  - server: '*'
    methods:
      - all
    tools:
      - all
  - agents:
      actions:
        - action: list_agents
          resources:
            - all
        - action: get_agent
          resources:
            - all
        - action: publish_agent
          resources:
            - all
        - action: modify_agent
          resources:
            - all
        - action: delete_agent
          resources:
            - all

registry-power-user:
  - server: api
    methods:
      - initialize
      - GET
      - POST
      - PUT
      - DELETE
  - agents:
      actions:
        - action: list_agents
          resources:
            - all
        - action: get_agent
          resources:
            - all

registry-user:
  - server: api
    methods:
      - initialize
      - GET
      - POST
  - agents:
      actions:
        - action: list_agents
          resources:
            - all
        - action: get_agent
          resources:
            - all
        - action: publish_agent
          resources:
            - all

registry-read-only:
  - server: api
    methods:
      - initialize
      - GET
  - agents:
      actions:
        - action: list_agents
          resources:
            - all
        - action: get_agent
          resources:
            - all
